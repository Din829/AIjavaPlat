# 社内業務サポートAIプラットフォーム - 前端开发计划 (正式版)

## MVP 完成状况总结

前端 MVP 开发阶段已实现以下核心功能：
- 项目初始化 (Vite, Vue3, TypeScript) 及核心库集成 (Pinia, Vue Router, Naive UI, Axios)。
- 完整的用户认证流程 (登录、注册、登出、路由守卫、状态持久化)。
- API Token 管理功能 (列表、创建、删除)。
- Prompt 管理功能 (列表、创建、编辑、删除)。
- 网页内容摘要功能，支持用户选择 API Token。
- API 服务层、状态管理模块化以及基础的全局错误处理。

主要的 MVP 收尾工作包括：解决已知的 TypeScript 类型检查问题 (暂时通过 `@ts-nocheck` 绕过) 和 Naive UI 全局消息提示的渲染 bug，以及完成代码审查、构建测试。

---

## 正式版开发规划

### 新增模块：OCR文档处理与交互界面

**总体方向：**
为用户提供流畅的文档上传体验，清晰地展示后端OCR服务处理后的文档内容，并逐步构建支持更高级文档交互（如内容选择、高亮、未来可能的文档问答）的用户界面。

**关键UI/UX、组件、状态管理与数据处理：**

1.  **核心页面与组件：**
    *   **新增 `OcrPage.vue` (或在现有仪表盘集成新功能区)：** 作为OCR功能主界面。
    *   **文件上传组件：** (Naive UI `n-upload` 或自定义) 支持多格式、大小限制、拖拽等。
    *   **处理状态与反馈：** (Naive UI `n-spin`, `n-progress`, `n-alert`, `messageService`) 清晰展示上传进度、后端处理状态（等待、处理中、成功、失败）及错误信息。
    *   **结果展示组件：**
        *   **核心挑战：** 优雅地渲染后端返回的**结构化JSON**。目标是尽可能还原文档布局或按特定需求格式化输出。
        *   **(需调研/设计)：** 可能需要自定义Vue组件来递归渲染JSON中的页面、文本块、表格、图片等元素，并利用其坐标、类型等元数据进行布局。前端渲染逻辑需要具备一定的灵活性，以适应后端JSON数据可能存在的逐步完善和字段可用性演进过程。
        *   初期可先支持渲染提取的文本内容、简单表格和图片（通过URL或Base64）。
        *   考虑使用Markdown渲染库作为一种可选的、简化的展示方式（如果后端JSON中包含Markdown片段，或者作为一种快速预览方案）。

2.  **API服务层 (`src/services/ocrService.ts`)：**
    *   功能不变：封装调用后端OCR API的逻辑。

3.  **状态管理 (`src/stores/ocrStore.ts` - Pinia)：**
    *   **核心职责：** 管理文件上传状态、OCR任务状态（如果异步）、后端返回的**原始结构化JSON结果**，以及经过前端处理后用于渲染的数据。
    *   **Actions：** 调用`ocrService`，处理异步轮询，将后端返回的JSON转换为前端组件易于消费的格式。

4.  **数据处理与渲染逻辑：**
    *   重点在于如何解析后端返回的复杂JSON，并将其映射到可渲染的Vue组件结构上。
    *   需要定义清晰的前端数据模型来对应后端JSON中的各种元素类型。

5.  **用户交互增强 (远期/可选)：**
    *   文本选择与复制功能。
    *   对识别结果的简单反馈机制（例如，标记某处识别错误）。
    *   多文档管理界面（如果支持批量上传和历史记录）。

6.  **(远期) 文档问答界面集成：**
    *   配合后端文档问答功能的实现，设计和开发相应的用户问答交互界面（如聊天框、问答历史）。

**(需与后端协同的关键点)：**
*   明确 `/api/ocr/upload` 接口接受的文件格式、大小限制和可能的处理选项。
*   确定异步处理流程中，任务状态和结果的获取方式及API。
*   **最重要：后端返回的OCR结果（结构化JSON）的具体数据结构。**
    *   **当前状态**：后端Python微服务由于在集成 `docling` 库时遇到核心类型导入问题，目前采用"黑盒"方式和运行时属性探查来生成此JSON (详情参见后端 `0518问题.txt` 和 `DEVELOPMENT_PLAN.md`)。
    *   **协同要求**：前端开发需要与后端保持密切沟通，以了解每个迭代阶段Python微服务实际能够输出的JSON字段及其详细程度和准确性。前端的数据模型、解析逻辑、渲染组件的开发需基于后端实际提供的JSON样本进行，并为后端JSON结构的逐步完善和演进预留灵活性。

(后续具体计划将在此处添加) 