# 后端OCR功能开发进度与计划 (截至 YYYY-MM-DD) 
## （请将YYYY-MM-DD替换为今天的日期，例如 2024-05-17）

## 今日主要进展与讨论成果

1.  **明确OCR功能实现的技术选型（方案A）：**
    *   **核心思路：** 由一个独立的Python微服务主导文档处理，Java后端负责业务逻辑和API暴露。
    *   **Python微服务职责：**
        *   **Docling主导深度文档解析：** 利用Docling内置的解析器、布局分析模型（如DocLayNet）、表格识别模型（如TableFormer）及可配置的OCR引擎（如Tesseract, EasyOCR）进行全面的结构化解析。
        *   **（可选）Gemini进行靶向增强：** 对于Docling难以处理的特定图像区域或内容块，调用Gemini API进行增强处理。
        *   **核心输出：** 一份详尽的、结构化的JSON文档，作为与Java后端交互的数据契约。
    *   **Java后端职责：**
        *   新增`OcrController`和`OcrService`。
        *   负责接收前端文件上传，调用Python OCR微服务，管理可能的异步任务，处理并向前端返回结果。
    *   **前端职责：**
        *   实现文件上传界面。
        *   核心挑战在于解析并渲染后端返回的结构化JSON，以尽可能还原文档原貌。

2.  **定义了Python微服务输出的JSON核心结构草案：**
    *   该JSON结构旨在全面描述文档内容和结构，包含`document_metadata`、`pages`（内含`elements`数组，每个元素有`id`, `type`, `bbox`, `content_text`, `style_info`以及类型特有属性如`level` for heading, `items` for list, `rows`/`cells` for table, `src_type`/`data` for image, `content_items` for generic `block`等）。
    *   此结构为前后端开发提供了关键的数据交换标准。

3.  **更新了核心项目规划文档：**
    *   `DEVELOPMENT_PLAN.md`：更新了"智能OCR及文档理解服务"模块的规划，明确了技术实现路径（方案A），细化了Python微服务职责、Java后端集成方式、API设计要点，并包含了JSON输出结构草案。
    *   `my-ai-platform-frontend/FRONTEND_PLAN.md`：更新了"OCR文档处理与交互界面"模块的规划，明确了前端将接收和处理后端返回的结构化JSON，并强调了渲染此JSON的挑战和策略，以及对后端计划中定义的JSON结构的依赖。

## 当前状态

*   OCR功能的整体技术方案和前后端职责已初步明确。
*   核心数据交换格式（Python微服务输出的JSON结构）已有详细草案。
*   项目规划文档已同步更新，为下一阶段的开发奠定了基础。

## 下一步行动计划

1.  **【核心任务】细化并最终确定Python微服务输出的JSON Schema：**
    *   基于当前的草案，进一步思考各种边缘情况和实际文档的复杂性，完善JSON字段和数据类型。
    *   考虑版本化此JSON Schema。

2.  **【后端Python微服务】原型开发与技术验证：**
    *   **任务2.1：Docling深度解析能力验证：**
        *   实际搭建Docling环境，处理多种代表性文档（复杂PDF、扫描件、图文混排）。
        *   验证Docling提取结构化信息（文本块、表格、图片、列表及其`bbox`等）的能力。
        *   实现将`DoclingDocument`对象序列化为我们定义的JSON结构（或其v1版本）的功能。
    *   **任务2.2：（可选）Gemini靶向增强原型：**
        *   针对Docling处理不佳的特定图片或文本块，编写脚本调用Gemini API进行处理。
        *   探索如何将Gemini的结果有效整合回主JSON结构中。
    *   **任务2.3：搭建基础Python API服务：**
        *   使用FastAPI或Flask，搭建一个能接收文件、调用上述Docling（和可选的Gemini）处理逻辑，并返回约定JSON格式结果的简单API服务。

3.  **【后端Java】API设计与初步实现：**
    *   **任务3.1：设计`OcrController`的API端点** (文件上传、状态查询、结果获取)。
    *   **任务3.2：设计`OcrService`接口**，明确与Python微服务的交互方式（同步/异步初步评估）。
    *   **任务3.3：创建相关的DTOs**，特别是用于承载从Python微服务获取的JSON结果的DTO。

4.  **【前端】技术预研与初步设计：**
    *   **任务4.1：研究前端渲染方案：** 针对后端定义的JSON结构，调研如何高效、灵活地在Vue中将其渲染出来，特别是基于`bbox`的布局和复杂元素的展示。
    *   **任务4.2：设计`OcrPage.vue`的初步界面布局**和用户交互流程。
    *   **任务4.3：规划`ocrStore.ts`的状态和actions**，以配合后端的API和数据结构。

5.  **【团队协同】明确初期交付范围（MVP of OCR）：**
    *   确定OCR功能第一个可交付版本需要支持的文档类型、输出信息的详细程度、以及前端渲染的保真度级别。例如，初期可能只要求准确提取文本和简单表格，前端进行基础渲染。

---
*本文档将根据后续开发进展持续更新。* 